<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Details - EasyCart</title>
    <link rel="stylesheet" href="../css/product-detail.css">
</head>
<body>
    <nav>
        <div class="logo">
            <span class="logo-icon">
                <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
            </span>
            EasyCart
        </div>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="product-listing.html">Products</a></li>
            <li><a href="cart.html">Cart <span class="cart-count" id="cartCount">0</span></a></li>
            <li><a href="login.html">Login</a></li>
            <li><a href="my-orders.html">My Orders</a></li>
        </ul>
    </nav>

    <div class="container">
        <a href="product-listing.html" class="back-link">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="15 18 9 12 15 6"></polyline>
            </svg>
            Back to Products
        </a>

        <div class="product-detail">
            <div class="product-image-section">
                <img id="productImage" src="" alt="Product Image">
            </div>

            <div class="product-info">
                <div class="product-badge" id="productBadge"></div>
                <h1 id="productName">Loading...</h1>

                <div class="rating" id="productRating">
                    <!-- Stars will be rendered by JS -->
                </div>

                <div class="price-section">
                    <span class="price" id="productPrice">Rs. 0</span>
                    <span class="original-price" id="originalPrice">Rs. 0</span>
                    <span class="discount" id="discountPercent">0% OFF</span>
                </div>

                <p class="description" id="productDescription">
                    Loading product description...
                </p>

                <div class="features">
                    <h3>Key Features:</h3>
                    <ul>
                        <li>Premium quality materials</li>
                        <li>Advanced technology</li>
                        <li>Lightweight design</li>
                        <li>Durable construction</li>
                        <li>Multiple color options</li>
                        <li>1 Year Warranty</li>
                    </ul>
                </div>

                <div class="quantity-section">
                    <label>Quantity:</label>
                    <div class="quantity-controls">
                        <button onclick="changeQuantity(-1)">-</button>
                        <span id="quantity">1</span>
                        <button onclick="changeQuantity(1)">+</button>
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="add-to-cart" onclick="addToCart()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                        Add to Cart
                    </button>
                    <button class="buy-now" onclick="buyNow()">Buy Now</button>
                </div>

                <div class="delivery-info">
                    <div class="delivery-item">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="1" y="3" width="15" height="13"></rect>
                            <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                            <circle cx="5.5" cy="18.5" r="2.5"></circle>
                            <circle cx="18.5" cy="18.5" r="2.5"></circle>
                        </svg>
                        <div>
                            <strong>Free Delivery</strong>
                            <p>Orders above Rs. 999</p>
                        </div>
                    </div>
                    <div class="delivery-item">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polyline points="23 4 23 10 17 10"></polyline>
                            <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                        </svg>
                        <div>
                            <strong>Easy Returns</strong>
                            <p>7 Days Return Policy</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <p>&copy; 2026 EasyCart - All Rights Reserved</p>
        </div>
    </footer>

    <script>
        let currentProduct = null;
        let quantity = 1;

        // Load product from localStorage or URL
        function loadProduct() {
            const urlParams = new URLSearchParams(window.location.search);
            const productId = urlParams.get('id');
            
            // Try to get product from localStorage
            const storedProduct = localStorage.getItem('selectedProduct');
            if (storedProduct) {
                currentProduct = JSON.parse(storedProduct);
                displayProduct(currentProduct);
            } else {
                // Fallback default product
                currentProduct = {
                    id: 1,
                    name: "Premium Sneakers",
                    category: "fashion",
                    price: 2499,
                    originalPrice: 3999,
                    image: "../public/images/products/sneakers.jpg",
                    rating: 5,
                    reviews: 128,
                    badge: "Best Seller",
                    description: "Experience ultimate comfort with our Premium Sneakers. Crafted with high-quality materials, these shoes feature advanced cushioning technology designed for all-day wear."
                };
                displayProduct(currentProduct);
            }
        }

        // Display product details
        function displayProduct(product) {
            document.getElementById('productImage').src = product.image;
            document.getElementById('productImage').alt = product.name;
            document.getElementById('productName').textContent = product.name;
            document.getElementById('productPrice').textContent = `Rs. ${product.price.toLocaleString()}`;
            document.getElementById('originalPrice').textContent = `Rs. ${product.originalPrice.toLocaleString()}`;
            document.getElementById('productDescription').textContent = product.description;
            
            // Calculate and display discount
            const discountPercent = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
            document.getElementById('discountPercent').textContent = `${discountPercent}% OFF`;
            
            // Display badge
            const badgeElement = document.getElementById('productBadge');
            if (product.badge) {
                badgeElement.textContent = product.badge;
                badgeElement.style.display = 'inline-block';
            } else {
                badgeElement.style.display = 'none';
            }
            
            // Display rating
            const ratingHTML = generateStars(product.rating) + ` <span>(${product.reviews} reviews)</span>`;
            document.getElementById('productRating').innerHTML = ratingHTML;
            
            // Update page title
            document.title = `${product.name} - EasyCart`;
        }

        // Generate star rating HTML
        function generateStars(rating) {
            let stars = '';
            for (let i = 0; i < 5; i++) {
                if (i < rating) {
                    stars += '<svg width="18" height="18" viewBox="0 0 24 24" fill="#f59e0b"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>';
                } else {
                    stars += '<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="#f59e0b" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>';
                }
            }
            return stars;
        }

        // Change quantity
        function changeQuantity(change) {
            quantity = Math.max(1, quantity + change);
            document.getElementById('quantity').textContent = quantity;
        }

        // Add to cart
        function addToCart() {
            if (!currentProduct) return;
            
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            
            // Check if product already in cart
            const existingIndex = cart.findIndex(item => item.id === currentProduct.id);
            
            if (existingIndex > -1) {
                cart[existingIndex].quantity += quantity;
            } else {
                cart.push({
                    id: currentProduct.id,
                    name: currentProduct.name,
                    price: currentProduct.price,
                    image: currentProduct.image,
                    quantity: quantity
                });
            }
            
            localStorage.setItem('cart', JSON.stringify(cart));
            updateCartCount();
            
            // Show success message
            alert(`${currentProduct.name} added to cart!`);
        }

        // Buy now - add to cart and go to checkout
        function buyNow() {
            addToCart();
            window.location.href = 'cart.html';
        }

        // Update cart count
        function updateCartCount() {
            const cart = JSON.parse(localStorage.getItem('cart')) || [];
            const count = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = count;
        }

        // Initialize
        loadProduct();
        updateCartCount();
    </script>
</body>
</html>
